<simulation>
  <archetypes>
    <spec>
      <lib>agents</lib>
      <name>NullRegion</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Source</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Reactor</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Mixer</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Separations</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Storage</name>
    </spec>
    <spec>
      <lib>cycamore</lib>
      <name>Sink</name>
    </spec>
    <spec>
      <lib>d3ploy.timeseries_inst</lib>
      <name>TimeSeriesInst</name>
    </spec>
    <spec>
      <lib>d3ploy.supply_driven_deployment_inst</lib>
      <name>SupplyDrivenDeploymentInst</name>
    </spec>
  </archetypes>

  <control>
    <duration>10</duration>
    <startmonth>1</startmonth>
    <startyear>2000</startyear>
  </control>

  <facility>
    <config>
      <Source>
        <outcommod>sourceoutput</outcommod>
        <outrecipe>source_recipe</outrecipe>
        <throughput>3000</throughput>
      </Source>
    </config>
    <name>source</name>
  </facility>

  <facility>
    <name>separations1</name>
    <config>
      <Separations>
         <feed_commods>   <val>reactor1output</val> </feed_commods>
         <feed_commod_prefs> <val>1.0</val> </feed_commod_prefs>
         <feed_recipe>source_recipe</feed_recipe>
         <feedbuf_size>1e6</feedbuf_size>
         <throughput>1e6</throughput>
         <leftover_commod>reprocess_waste1</leftover_commod>
         <leftoverbuf_size>1e6</leftoverbuf_size>
         <streams>
          <item>
            <commod>separations1Pu</commod>
            <info>
              <buf_size>1e6</buf_size>
              <efficiencies>
                <item>
                  <comp>Pu</comp> <eff>1</eff>
                </item>
              </efficiencies>
            </info>
          </item>
          <item>
            <commod>separations1U</commod>
            <info>
              <buf_size>1e6</buf_size>
              <efficiencies>
                <item>
                  <comp>U</comp> <eff>1</eff>
                </item>
              </efficiencies>
            </info>
          </item>
        </streams>
      </Separations>
    </config>
  </facility>

  <facility>
    <name>mixer</name>
    <config>
        <Mixer>
            <in_streams>
                <stream>
                    <info>
                        <mixing_ratio>0.5</mixing_ratio>
                        <buf_size>1e6</buf_size>
                    </info>
                    <commodities>
                        <item>
                            <commodity>separations1Pu</commodity>
                            <pref>1.0</pref>
                        </item>
                        <item>
                            <commodity>separations2Pu</commodity>
                            <pref>1.0</pref>
                        </item>                        
                    </commodities>
                </stream>
                <stream>
                    <info>
                        <mixing_ratio>0.5</mixing_ratio>
                        <buf_size>1e6</buf_size>
                    </info>
                    <commodities>
                        <item>
                            <commodity>separations1_U</commodity>
                            <pref>1.0</pref>
                        </item>
                        <item>
                            <commodity>separations2Pu</commodity>
                            <pref>1.0</pref>
                        </item>                        
                    </commodities>
                </stream>
            </in_streams>
            <out_commod>mixeroutput</out_commod>
            <out_buf_size>1e6</out_buf_size>
            <throughput>1e6</throughput>
        </Mixer>
    </config>
  </facility>

  <facility>
    <config>
      <Reactor>
        <assem_size>1000</assem_size>
        <cycle_time>1</cycle_time>
        <fuel_incommods>
          <val>sourceoutput</val>
        </fuel_incommods>
        <fuel_outcommods>
          <val>reactor1output</val>
        </fuel_outcommods>
        <fuel_outrecipes>
          <val>reactor_recipe</val>
        </fuel_outrecipes>
        <n_assem_batch>1</n_assem_batch>
        <n_assem_core>3</n_assem_core>
        <power_cap>1000</power_cap>
        <refuel_time>0</refuel_time>
      </Reactor>
    </config>
    <name>reactor1</name>
  </facility>

  <facility>
    <config>
      <Reactor>
        <assem_size>1000</assem_size>
        <cycle_time>1</cycle_time>
        <fuel_incommods>
          <val>mixeroutput</val>
        </fuel_incommods>
        <fuel_outcommods>
          <val>reactor2output</val>
        </fuel_outcommods>
        <fuel_outrecipes>
          <val>reactor_recipe</val>
        </fuel_outrecipes>
        <n_assem_batch>1</n_assem_batch>
        <n_assem_core>3</n_assem_core>
        <power_cap>1000</power_cap>
        <refuel_time>0</refuel_time>
      </Reactor>
    </config>
    <name>reactor2</name>
  </facility>

  <facility>
    <name>separations2</name>
    <config>
      <Separations>
         <feed_commods>   <val>reactor2output</val> </feed_commods>
         <feed_commod_prefs> <val>1.0</val> </feed_commod_prefs>
         <feed_recipe>source_recipe</feed_recipe>
         <feedbuf_size>1e6</feedbuf_size>
         <throughput>1e6</throughput>
         <leftover_commod>reprocess_waste2</leftover_commod>
         <leftoverbuf_size>1e6</leftoverbuf_size>
         <streams>
          <item>
            <commod>separations2Pu</commod>
            <info>
              <buf_size>1e6</buf_size>
              <efficiencies>
                <item>
                  <comp>Pu</comp> <eff>1</eff>
                </item>
              </efficiencies>
            </info>
          </item>
          <item>
            <commod>separations2U</commod>
            <info>
              <buf_size>1e6</buf_size>
              <efficiencies>
                <item>
                  <comp>U</comp> <eff>1</eff>
                </item>
              </efficiencies>
            </info>
          </item>
        </streams>
      </Separations>
    </config>
</facility>

  <facility>
    <config>
      <Sink>
        <in_commods>
          <val>reprocess_waste1</val>
          <val>reprocess_waste2</val>
        </in_commods>
        <max_inv_size>1e6</max_inv_size>
      </Sink>
    </config>
    <name>sink</name>
  </facility>

  <recipe>
    <basis>mass</basis>
    <name>source_recipe</name>
    <nuclide>
      <comp>0.5</comp>
      <id>U235</id>
    </nuclide>
    <nuclide>
      <comp>0.5</comp>
      <id>Pu238</id>
    </nuclide>
  </recipe>

  <recipe>
    <basis>mass</basis>
    <name>reactor_recipe</name>
    <nuclide>
      <comp>0.5</comp>
      <id>U235</id>
    </nuclide>
    <nuclide>
      <comp>0.5</comp>
      <id>Pu238</id>
    </nuclide>
  </recipe>

  <region>
    <config>
      <NullRegion>
      </NullRegion>
    </config>
    <institution>
      <config>
        <TimeSeriesInst>
          <calc_method>arma</calc_method>
          <record>1</record>
	        <demand_std_dev>0.0</demand_std_dev>
          <demand_eq>1000*t</demand_eq>
          <commodities>
              <val>POWER_reactor2_3000</val>
              <val>POWER_reactor1_3000</val>
              <val>sourceoutput_source_3000</val>
          </commodities>
          <steps>1</steps>
        </TimeSeriesInst>
      </config>
    <name>demand_inst</name>
    </institution>
     <institution>
      <config>
        <SupplyDrivenDeploymentInst>
          <calc_method>arma</calc_method>
          <commodities>
            <val>separations1U_separations1_1e6</val>
            <val>mixeroutput_mixer_1e6</val>
            <val>separations2U_separations2_1e6</val>
          </commodities>
          <capacity_std_dev>1.0</capacity_std_dev>
          <record>1</record>
          <steps>1</steps>
        </SupplyDrivenDeploymentInst>
      </config>
      <name>supply_inst</name>
    </institution>
    <name>SingleRegion</name>
  </region>

</simulation>